#include "PWMG.h"
#include "ADC.h"
#include "NOKIA5110.h"

void delayMs(int n);
 unsigned char  servo[504] = {
  0,   0,   0, 252, 252, 252,   0,   0,   0,   0,   0, 252, 
252, 140, 140, 140, 140, 140, 140, 140,   0, 252, 252, 140, 
140, 140, 140, 140, 140,   0, 252, 252, 140, 140, 140, 140, 
252, 252,   0, 252, 252,   0,   0,   0,   0,   0, 252, 252, 
  0, 248, 252,  28,  12,   4,  12,  28, 252, 248,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0, 103, 103, 103,   0,   0,   0,   0,   0,  97, 
 97,  97,  97,  97,  97,  97, 127, 127,   0, 127, 127,  97, 
 97,  97,  97,  97,  97,   0, 127, 127,   7,  15,  29,  57, 
113,  97,  64,  15,  31,  48,  96,  96,  96,  48,  31,  15, 
  0,  63, 127, 112,  96,  64,  96, 112, 127,  63,   0,   0, 
  0,   0,   0,   0,   0, 192, 224, 176, 152, 140, 134, 130, 
178, 186, 186, 186, 154, 194,  98,  50,  26,  14,   6,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0, 240, 248, 252, 252, 252, 252, 252, 255, 255, 
255, 255, 252,  60,  28,  12, 252,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0, 255, 255,  99,  99,  99,  99, 
 99, 255, 254,   0, 127, 127,  96,  96,  96,  96,  96, 255, 
255,   0,   0,   0,   0,   0,   0, 112, 112,   0, 128, 128, 
128, 128, 128,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 
255, 255, 255,   0,   0,   0, 255,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,  15,  15,  12,  12,  12,  12, 
 12,  15,   7,   0,  12,  12,  12,  12,  12,  12,  12,  15, 
 15,   0,   0,   0,   0,   0,   0,  14,  14,   0,   1,   1, 
  1,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0, 127, 127, 127, 127, 127, 127, 127, 127, 127, 
127, 127, 127,  96,  48,  24,  15,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0, 248, 168, 168, 168,   0, 
248, 128, 128, 128,   0, 184, 168, 168, 232,   0, 248,  40, 
 40, 248,   0, 248,  40,  40,  40,   0, 248,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0
};

 
// ------------------------------------------------------  
// Picture name: servoGUI_bmp            
// GLCD Model: Nokia3310 Like            
// ------------------------------------------------------  

unsigned char  servoGUI_bmp[504] = {
  0,   0,   0, 252, 252, 252,   0,   0,   0,   0,   0, 252, 
252, 140, 140, 140, 140, 140, 140, 140,   0, 252, 252, 140, 
140, 140, 140, 140, 140,   0, 252, 252, 140, 140, 140, 140, 
252, 252,   0, 252, 252,   0,   0,   0,   0,   0, 252, 252, 
  0, 248, 252,  28,  12,   4,  12,  28, 252, 248,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0, 103, 103, 103,   0,   0,   0,   0,   0,  97, 
 97,  97,  97,  97,  97,  97, 127, 127,   0, 127, 127,  97, 
 97,  97,  97,  97,  97,   0, 127, 127,   7,  15,  29,  57, 
113,  97,  64,  15,  31,  48,  96,  96,  96,  48,  31,  15, 
  0,  63, 127, 112,  96,  64,  96, 112, 127,  63,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 
  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0
};


int main(void){
	U32_t digital=0,percentage=0;
	PWMGEN_SETUP();
	ADC0_SS3_Init(4,3,SW);
	
	NOKIA5110_Setup(NORMAL);
	Nokia5110_Clear();
  Nokia5110_DrawImag(servo);
	delayMs(2000);
while(1){
    
	 digital=ADC0_SS3_Read();
   digital=(U32_t)((double)digital/6.825);
	 percentage=(digital*180)/600;
	 PWMGEN_DUTY(digital);
	 Nokia5110_Clear();
	 Nokia5110_Cursor(0,0);
	 Nokia5110_DrawImag(servoGUI_bmp);
	// Nokia5110_Cursor(0,0);
	 //Nokia5110_OutString((U8_t*)"servo");
	 Nokia5110_Cursor(5,0);
   Nokia5110_OutNumbers(percentage);	 
	

}	
}
	/* delay n milliseconds (16 MHz CPU clock) */
void delayMs(int n)
{
int i, j;
for(i = 0 ; i < n; i++)
for(j = 0; j < 3180; j++)
{} /* do nothing for 1 ms */
}
	
	


  




